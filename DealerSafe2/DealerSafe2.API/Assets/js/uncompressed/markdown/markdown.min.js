(function(n){function c(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function l(){var n=require("util");return"Markdown.mk_block( "+n.inspect(this.toString())+", "+n.inspect(this.trailing)+", "+n.inspect(this.lineNumber)+" )"}function o(n){for(var t=0,i=-1;(i=n.indexOf("\n",i+1))!==-1;)t++;return t}function f(n,t){function u(n){this.len_after=n;this.name="close_"+t}var i=n+"_state",r=n=="strong"?"em_state":"strong_state";return function(f){var o,s,c;if(this[i][0]==t)return this[i].shift(),[f.length,new u(f.length-t.length)];o=this[r].slice();s=this[i].slice();this[i].unshift(t);var e=this.processInline(f.substr(t.length)),h=e[e.length-1],l=this[i].shift();return h instanceof u?(e.pop(),c=f.length-h.len_after,[c,[n].concat(e)]):(this[r]=o,this[i]=s,[t.length,t])}}function v(n){for(var r=n.split(""),t=[""],u=!1,i;r.length;){i=r.shift();switch(i){case" ":u?t[t.length-1]+=i:t.push("");break;case"'":case'"':u=!u;break;case"\\":i=r.shift();default:t[t.length-1]+=i}}return t}function i(n){return u(n)&&n.length>1&&typeof n[1]=="object"&&!u(n[1])?n[1]:undefined}function s(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function h(n){var i,u;if(typeof n=="string")return s(n);var t=n.shift(),r={},f=[];for(!n.length||typeof n[0]!="object"||n[0]instanceof Array||(r=n.shift());n.length;)f.push(arguments.callee(n.shift()));i="";for(u in r)i+=" "+u+'="'+s(r[u])+'"';return t=="img"||t=="br"||t=="hr"?"<"+t+i+"/>":"<"+t+i+">"+f.join("")+"<\/"+t+">"}function y(n,t,r){var e,u,f,s,o,h;if(r=r||{},u=n.slice(0),typeof r.preprocessTreeNode=="function"&&(u=r.preprocessTreeNode(u,t)),f=i(u),f){u[1]={};for(e in f)u[1][e]=f[e];f=u[1]}if(typeof u=="string")return u;switch(u[0]){case"header":u[0]="h"+u[1].level;delete u[1].level;break;case"bulletlist":u[0]="ul";break;case"numberlist":u[0]="ol";break;case"listitem":u[0]="li";break;case"para":u[0]="p";break;case"markdown":u[0]="html";f&&delete f.references;break;case"code_block":u[0]="pre";e=f?2:1;s=["code"];s.push.apply(s,u.splice(e));u[e]=s;break;case"inlinecode":u[0]="code";break;case"img":u[1].src=u[1].href;delete u[1].href;break;case"linebreak":u[0]="br";break;case"link":u[0]="a";break;case"link_ref":if(u[0]="a",o=t[f.ref],o)delete f.ref,f.href=o.href,o.title&&(f.title=o.title),delete f.original;else return f.original;break;case"img_ref":if(u[0]="img",o=t[f.ref],o)delete f.ref,f.src=o.href,o.title&&(f.title=o.title),delete f.original;else return f.original}if(e=1,f){for(h in u[1])e=2;e===1&&u.splice(e,1)}for(;e<u.length;++e)u[e]=arguments.callee(u[e],t,r);return u}function w(n){for(var t=i(n)?2:1;t<n.length;)typeof n[t]=="string"?t+1<n.length&&typeof n[t+1]=="string"?n[t]+=n.splice(t+1,1)[0]:++t:(arguments.callee(n[t]),++t)}var t=n.Markdown=function t(n){switch(typeof n){case"undefined":this.dialect=t.dialects.Gruber;break;case"object":this.dialect=n;break;default:if(n in t.dialects)this.dialect=t.dialects[n];else throw new Error("Unknown Markdown dialect '"+String(n)+"'");}this.em_state=[];this.strong_state=[];this.debug_indent=""},r,u,e;n.parse=function(n,i){var r=new t(i);return r.toTree(n)};n.toHTML=function(t,i,r){var u=n.toHTMLTree(t,i,r);return n.renderJsonML(u)};n.toHTMLTree=function(n,t,r){var u,f,e;return typeof n=="string"&&(n=this.parse(n,t)),u=i(n),f={},u&&u.references&&(f=u.references),e=y(n,f,r),w(e),e};r=t.mk_block=function(n,t,i){arguments.length==1&&(t="\n\n");var r=new String(n);return r.trailing=t,r.inspect=l,r.toSource=c,i!=undefined&&(r.lineNumber=i),r};t.prototype.split_blocks=function(n){var u=/([\s\S]+?)($|\n(?:\s*\n|$)+)/g,f=[],t,i=1;for((t=/^(\s*\n)/.exec(n))!=null&&(i+=o(t[0]),u.lastIndex=t[0].length);(t=u.exec(n))!==null;)f.push(r(t[1],t[2],i)),i+=o(t[0]);return f};t.prototype.processBlock=function(n,t){var f=this.dialect.block,e=f.__order__,r,i;if("__call__"in f)return f.__call__.call(this,n,t);for(r=0;r<e.length;r++)if(i=f[e[r]].call(this,n,t),i)return(!u(i)||i.length>0&&!u(i[0]))&&this.debug(e[r],"didn't return a proper array"),i;return[]};t.prototype.processInline=function(n){return this.dialect.inline.__call__.call(this,String(n))};t.prototype.toTree=function(n,t){var i=n instanceof Array?n:this.split_blocks(n),u=this.tree,r;try{this.tree=t||this.tree||["markdown"];n:while(i.length)(r=this.processBlock(i.shift(),i),r.length)&&this.tree.push.apply(this.tree,r);return this.tree}finally{t&&(this.tree=u)}};t.prototype.debug=function(){var n=Array.prototype.slice.call(arguments);n.unshift(this.debug_indent);typeof print!="undefined"&&print.apply(print,n);typeof console!="undefined"&&typeof console.log!="undefined"&&console.log.apply(null,n)};t.prototype.loop_re_over_block=function(n,t,i){for(var u,r=t.valueOf();r.length&&(u=n.exec(r))!=null;)r=r.substr(u[0].length),i.call(this,u);return r};t.dialects={};t.dialects.Gruber={block:{atxHeader:function(n,t){var i=n.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/),u;return i?(u=["header",{level:i[1].length}],Array.prototype.push.apply(u,this.processInline(i[2])),i[0].length<n.length&&t.unshift(r(n.substr(i[0].length),n.trailing,n.lineNumber+2)),[u]):undefined},setextHeader:function(n,t){var i=n.match(/^(.*)\n([-=])\2\2+(?:\n|$)/),u,f;return i?(u=i[2]==="="?1:2,f=["header",{level:u},i[1]],i[0].length<n.length&&t.unshift(r(n.substr(i[0].length),n.trailing,n.lineNumber+2)),[f]):undefined},code:function(n,t){var i=[],u=/^(?: {0,3}\t| {4})(.*)\n?/,f;if(!n.match(u))return undefined;n:do if(f=this.loop_re_over_block(u,n.valueOf(),function(n){i.push(n[1])}),f.length){t.unshift(r(f,n.trailing));break n}else if(t.length){if(!t[0].match(u))break n;i.push(n.trailing.replace(/[^\n]/g,"").substring(2));n=t.shift()}else break n;while(1);return[["code_block",i.join("\n")]]},horizRule:function(n,t){var i=n.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/),u;return i?(u=[["hr"]],i[1]&&u.unshift.apply(u,this.processBlock(i[1],[])),i[3]&&t.unshift(r(i[3])),u):undefined},lists:function(){function s(i){return new RegExp("(?:^("+n+"{0,"+i+"} {0,3})("+t+")\\s+)|(^"+n+"{0,"+(i-1)+"}[ ]{0,4})")}function h(n){return n.replace(/ {0,3}\t/g,"    ")}function u(n,t,i,r){var u,f,e,o;if(t){n.push(["para"].concat(i));return}for(u=n[n.length-1]instanceof Array&&n[n.length-1][0]=="para"?n[n.length-1]:n,r&&n.length>1&&i.unshift(r),f=0;f<i.length;f++)e=i[f],o=typeof e=="string",o&&u.length>1&&typeof u[u.length-1]=="string"?u[u.length-1]+=e:u.push(e)}function c(t,i){for(var o=new RegExp("^("+n+"{"+t+"}.*?\\n?)*$"),s=new RegExp("^"+n+"{"+t+"}","gm"),f=[],u,e;i.length>0;){o.exec(i[0])&&(u=i.shift(),e=u.replace(s,""),f.push(r(e,u.trailing,u.lineNumber)));break}return f}function f(n,t,i){var u=n.list,r=u[u.length-1],f;r[1]instanceof Array&&r[1][0]=="para"||(t+1==i.length?r.push(["para"].concat(r.splice(1))):(f=r.pop(),r.push(["para"].concat(r.splice(1)),f)))}var t="[*+-]|\\d+\\.",o=/[*+-]/,i=new RegExp("^( {0,3})("+t+")[ \t]+"),n="(?: {0,3}\\t| {4})";return function(n,t){function g(n){var t=o.exec(n[2])?["bulletlist"]:["numberlist"];return r.push({list:t,indent:n[1]}),t}var l=n.match(i),tt,y,d,w,rt,ut,ft,et;if(!l)return undefined;var r=[],v=g(l),a,b=!1,nt=[r[0].list],p;n:for(;;){for(tt=n.split(/(?=\n)/),y="",d=0;d<tt.length;d++){var k="",it=tt[d].replace(/^\n/,function(n){return k=n,""}),ot=s(r.length);if(l=it.match(ot),l[1]!==undefined){if(y.length&&(u(a,b,this.processInline(y),k),b=!1,y=""),l[1]=h(l[1]),w=Math.floor(l[1].length/4)+1,w>r.length)v=g(l),a.push(v),a=v[1]=["listitem"];else{for(rt=!1,p=0;p<r.length;p++)if(r[p].indent==l[1]){v=r[p].list;r.splice(p+1);rt=!0;break}rt||(w++,w<=r.length?(r.splice(w),v=r[w-1].list):(v=g(l),a.push(v)));a=["listitem"];v.push(a)}k=""}it.length>l[0].length&&(y+=k+it.substr(l[0].length))}if(y.length&&(u(a,b,this.processInline(y),k),b=!1,y=""),ut=c(r.length,t),ut.length>0&&(e(r,f,this),a.push.apply(a,this.toTree(ut,[]))),ft=t[0]&&t[0].valueOf()||"",ft.match(i)||ft.match(/^ /)){if(n=t.shift(),et=this.dialect.block.horizRule(n,t),et){nt.push.apply(nt,et);break}e(r,f,this);b=!0;continue n}break}return nt}}(),blockquote:function(n,t){var i,r,u,f,e,o;if(!n.match(/^>/m))return undefined;if(i=[],n[0]!=">"){for(r=n.split(/\n/),u=[];r.length&&r[0][0]!=">";)u.push(r.shift());n=r.join("\n");i.push.apply(i,this.processBlock(u.join("\n"),[]))}while(t.length&&t[0][0]==">")f=t.shift(),n=new String(n+n.trailing+f),n.trailing=f.trailing;return e=n.replace(/^> ?/gm,""),o=this.tree,i.push(this.toTree(e,["blockquote"])),i},referenceDefn:function(n,t){var e=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/,u,f;return n.match(e)?(i(this.tree)||this.tree.splice(1,0,{}),u=i(this.tree),u.references===undefined&&(u.references={}),f=this.loop_re_over_block(e,n,function(n){n[2]&&n[2][0]=="<"&&n[2][n[2].length-1]==">"&&(n[2]=n[2].substring(1,n[2].length-1));var t=u.references[n[1].toLowerCase()]={href:n[2]};n[4]!==undefined?t.title=n[4]:n[5]!==undefined&&(t.title=n[5])}),f.length&&t.unshift(r(f,n.trailing)),[]):undefined},para:function(n){return[["para"].concat(this.processInline(n))]}}};t.dialects.Gruber.inline={__oneElement__:function(n,t,i){var r,f,u;if(t=t||this.dialect.inline.__patterns__,f=new RegExp("([\\s\\S]*?)("+(t.source||t)+")"),r=f.exec(n),r){if(r[1])return[r[1].length,r[1]]}else return[n.length,n];return r[2]in this.dialect.inline&&(u=this.dialect.inline[r[2]].call(this,n.substr(r.index),r,i||[])),u||[r[2].length,r[2]]},__call__:function(n,t){function u(n){typeof n=="string"&&typeof i[i.length-1]=="string"?i[i.length-1]+=n:i.push(n)}for(var i=[],r;n.length>0;)r=this.dialect.inline.__oneElement__.call(this,n,t,i),n=n.substr(r.shift()),e(r,u);return i},"]":function(){},"}":function(){},"\\":function(n){return n.match(/^\\[\\`\*_{}\[\]()#\+.!\-]/)?[2,n[1]]:[1,"\\"]},"![":function(n){var t=n.match(/^!\[(.*?)\][ \t]*\([ \t]*(\S*)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/),i;return t?(t[2]&&t[2][0]=="<"&&t[2][t[2].length-1]==">"&&(t[2]=t[2].substring(1,t[2].length-1)),t[2]=this.dialect.inline.__call__.call(this,t[2],/\\/)[0],i={alt:t[1],href:t[2]||""},t[4]!==undefined&&(i.title=t[4]),[t[0].length,["img",i]]):(t=n.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/),t)?[t[0].length,["img_ref",{alt:t[1],ref:t[2].toLowerCase(),original:t[0]}]]:[2,"!["]},"[":function(n){var l=String(n),h=t.DialectHelpers.inline_until_char.call(this,n.substr(1),"]"),u,f,o,e,r,i,c,s;if(!h)return[1,"["];if(u=1+h[0],f=h[1],n=n.substr(u),r=n.match(/^\s*\([ \t]*(\S+)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/),r){if(i=r[1],u+=r[0].length,i&&i[0]=="<"&&i[i.length-1]==">"&&(i=i.substring(1,i.length-1)),!r[3])for(c=1,s=0;s<i.length;s++)switch(i[s]){case"(":c++;break;case")":--c==0&&(u-=i.length-s,i=i.substring(0,s))}return i=this.dialect.inline.__call__.call(this,i,/\\/)[0],e={href:i||""},r[3]!==undefined&&(e.title=r[3]),o=["link",e].concat(f),[u,o]}return(r=n.match(/^\s*\[(.*?)\]/),r)?(u+=r[0].length,e={ref:(r[1]||String(f)).toLowerCase(),original:l.substr(0,u)},o=["link_ref",e].concat(f),[u,o]):f.length==1&&typeof f[0]=="string"?(e={ref:f[0].toLowerCase(),original:l.substr(0,u)},o=["link_ref",e,f[0]],[u,o]):[1,"["]},"<":function(n){var t;return(t=n.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))!=null?t[3]?[t[0].length,["link",{href:"mailto:"+t[3]},t[3]]]:t[2]=="mailto"?[t[0].length,["link",{href:t[1]},t[1].substr(7)]]:[t[0].length,["link",{href:t[1]},t[1]]]:[1,"<"]},"`":function(n){var t=n.match(/(`+)(([\s\S]*?)\1)/);return t&&t[2]?[t[1].length+t[2].length,["inlinecode",t[3]]]:[1,"`"]},"  \n":function(){return[3,["linebreak"]]}};t.dialects.Gruber.inline["**"]=f("strong","**");t.dialects.Gruber.inline.__=f("strong","__");t.dialects.Gruber.inline["*"]=f("em","*");t.dialects.Gruber.inline._=f("em","_");t.buildBlockOrder=function(n){var i=[];for(var t in n)t!="__order__"&&t!="__call__"&&i.push(t);n.__order__=i};t.buildInlinePatterns=function(n){var t=[],i,r,u;for(i in n)i.match(/^__.*__$/)||(r=i.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n"),t.push(i.length==1?r:"(?:"+r+")"));t=t.join("|");n.__patterns__=t;u=n.__call__;n.__call__=function(n,i){return i!=undefined?u.call(this,n,i):u.call(this,n,t)}};t.DialectHelpers={};t.DialectHelpers.inline_until_char=function(n,t){for(var i=0,r=[],u;;){if(n[i]==t)return i++,[i,r];if(i>=n.length)return null;u=this.dialect.inline.__oneElement__.call(this,n.substr(i));i+=u[0];r.push.apply(r,u.slice(1))}};t.subclassDialect=function(n){function t(){}function i(){}return t.prototype=n.block,i.prototype=n.inline,{block:new t,inline:new i}};t.buildBlockOrder(t.dialects.Gruber.block);t.buildInlinePatterns(t.dialects.Gruber.inline);t.dialects.Maruku=t.subclassDialect(t.dialects.Gruber);t.dialects.Maruku.processMetaHash=function(n){for(var u,i=v(n),r={},t=0;t<i.length;++t)/^#/.test(i[t])?r.id=i[t].substring(1):/^\./.test(i[t])?r["class"]=r["class"]?r["class"]+i[t].replace(/./," "):i[t].substring(1):/\=/.test(i[t])&&(u=i[t].split(/\=/),r[u[0]]=u[1]);return r};t.dialects.Maruku.block.document_meta=function(n){var t;if(n.lineNumber>1||!n.match(/^(?:\w+:.*\n)*\w+:.*$/))return undefined;i(this.tree)||this.tree.splice(1,0,{});t=n.split(/\n/);for(p in t){var r=t[p].match(/(\w+):\s*(.*)$/),u=r[1].toLowerCase(),f=r[2];this.tree[1][u]=f}return[]};t.dialects.Maruku.block.block_meta=function(n){var e=n.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/),r,t,u,o,f;if(!e)return undefined;if(r=this.dialect.processMetaHash(e[2]),e[1]===""){if(u=this.tree[this.tree.length-1],t=i(u),typeof u=="string")return undefined;t||(t={},u.splice(1,0,t));for(a in r)t[a]=r[a];return[]}o=n.replace(/\n.*$/,"");f=this.processBlock(o,[]);t=i(f[0]);t||(t={},f[0].splice(1,0,t));for(a in r)t[a]=r[a];return f};t.dialects.Maruku.block.definition_list=function(n,t){var f=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,e=["dl"],i,r,u;if(o=n.match(f)){for(r=[n];t.length&&f.exec(t[0]);)r.push(t.shift());for(u=0;u<r.length;++u){var o=r[u].match(f),s=o[1].replace(/\n$/,"").split(/\n/),h=o[2].split(/\n:\s+/);for(i=0;i<s.length;++i)e.push(["dt",s[i]]);for(i=0;i<h.length;++i)e.push(["dd"].concat(this.processInline(h[i].replace(/(\n)\s+/,"$1"))))}}else return undefined;return[e]};t.dialects.Maruku.inline["{:"]=function(n,t,r){var f,e,o,u,s;if(!r.length)return[2,"{:"];if(f=r[r.length-1],typeof f=="string")return[2,"{:"];if(e=n.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/),!e)return[2,"{:"];o=this.dialect.processMetaHash(e[1]);u=i(f);u||(u={},f.splice(1,0,u));for(s in o)u[s]=o[s];return[e[0].length,""]};t.buildBlockOrder(t.dialects.Maruku.block);t.buildInlinePatterns(t.dialects.Maruku.inline);u=Array.isArray||function(n){return Object.prototype.toString.call(n)=="[object Array]"};e=Array.prototype.forEach?function(n,t,i){return n.forEach(t,i)}:function(n,t,i){for(var r=0;r<n.length;r++)t.call(i||n,n[r],r,n)};n.renderJsonML=function(n,t){t=t||{};t.root=t.root||!1;var i=[];if(t.root)i.push(h(n));else for(n.shift(),!n.length||typeof n[0]!="object"||n[0]instanceof Array||n.shift();n.length;)i.push(h(n.shift()));return i.join("\n\n")}})(function(){return typeof exports=="undefined"?(window.markdown={},window.markdown):exports}());
/*
//# sourceMappingURL=markdown.min.js.map
*/